'use strict';let dbrBWasmDebug,dbrEngineResourcePath,dbrVersion,dbrProductKeys,dbrBRuntimeKeys,dbrDomain,dbrBNewDevice=!1,dbrBUseFullFeature=!1,dbrUUID,dbrLicenseServer="https://dbrjsauth.dynamsoft.com/v2/",dbrPromiseGetLicense,dbrLicenseInfo,dbrPromisePostConsumption=Promise.resolve();
!function(p){"object"==typeof exports&&"undefined"!=typeof module?module.exports=p():"function"==typeof define&&define.amd?define([],p):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).localforage=p()}(function(){return function q(d,g,m){function k(a,v){if(!g[a]){if(!d[a]){var f="function"==typeof require&&require;if(!v&&f)return f(a,!0);if(r)return r(a,!0);v=Error("Cannot find module '"+a+"'");throw v.code="MODULE_NOT_FOUND",v;}v=g[a]={exports:{}};
d[a][0].call(v.exports,function(f){return k(d[a][1][f]||f)},v,v.exports,q,d,g,m)}return g[a].exports}for(var r="function"==typeof require&&require,a=0;a<m.length;a++)k(m[a]);return k}({1:[function(d,g,m){(function(d){function k(){w=!0;for(var a,d,f=u.length;f;){d=u;u=[];for(a=-1;++a<f;)d[a]();f=u.length}w=!1}var r=d.MutationObserver||d.WebKitMutationObserver;if(r){var a=0;r=new r(k);var f=d.document.createTextNode("");r.observe(f,{characterData:!0});var m=function(){f.data=a=++a%2}}else if(d.setImmediate||
void 0===d.MessageChannel)m="document"in d&&"onreadystatechange"in d.document.createElement("script")?function(){var a=d.document.createElement("script");a.onreadystatechange=function(){k();a.onreadystatechange=null;a.parentNode.removeChild(a);a=null};d.document.documentElement.appendChild(a)}:function(){setTimeout(k,0)};else{var q=new d.MessageChannel;q.port1.onmessage=k;m=function(){q.port2.postMessage(0)}}var w,u=[];g.exports=function(a){1!==u.push(a)||w||m()}}).call(this,"undefined"!=typeof global?
global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(d,g,m){function q(){}function k(a){if("function"!=typeof a)throw new TypeError("resolver must be a function");this.state=H;this.queue=[];this.outcome=void 0;a!==q&&v(this,a)}function r(a,d,f){this.promise=a;"function"==typeof d&&(this.onFulfilled=d,this.callFulfilled=this.otherCallFulfilled);"function"==typeof f&&(this.onRejected=f,this.callRejected=this.otherCallRejected)}function a(a,d,f){w(function(){try{var g=
d(f)}catch(z){return u.reject(a,z)}g===a?u.reject(a,new TypeError("Cannot resolve promise with itself")):u.resolve(a,g)})}function f(a){var d=a&&a.then;if(a&&("object"==typeof a||"function"==typeof a)&&"function"==typeof d)return function(){d.apply(a,arguments)}}function v(a,d){function f(d){k||(k=!0,u.reject(a,d))}function g(d){k||(k=!0,u.resolve(a,d))}var k=!1,m=L(function(){d(g,f)});"error"===m.status&&f(m.value)}function L(a,d){var f={};try{f.value=a(d),f.status="success"}catch(P){f.status="error",
f.value=P}return f}var w=d(1),u={},E=["REJECTED"],A=["FULFILLED"],H=["PENDING"];g.exports=k;k.prototype.catch=function(a){return this.then(null,a)};k.prototype.then=function(d,f){if("function"!=typeof d&&this.state===A||"function"!=typeof f&&this.state===E)return this;var g=new this.constructor(q);this.state!==H?a(g,this.state===A?d:f,this.outcome):this.queue.push(new r(g,d,f));return g};r.prototype.callFulfilled=function(a){u.resolve(this.promise,a)};r.prototype.otherCallFulfilled=function(d){a(this.promise,
this.onFulfilled,d)};r.prototype.callRejected=function(a){u.reject(this.promise,a)};r.prototype.otherCallRejected=function(d){a(this.promise,this.onRejected,d)};u.resolve=function(a,d){var g=L(f,d);if("error"===g.status)return u.reject(a,g.value);if(g=g.value)v(a,g);else{a.state=A;a.outcome=d;g=-1;for(var k=a.queue.length;++g<k;)a.queue[g].callFulfilled(d)}return a};u.reject=function(a,d){a.state=E;a.outcome=d;for(var f=-1,g=a.queue.length;++f<g;)a.queue[f].callRejected(d);return a};k.resolve=function(a){return a instanceof
this?a:u.resolve(new this(q),a)};k.reject=function(a){var d=new this(q);return u.reject(d,a)};k.all=function(a){function d(a,d){f.resolve(a).then(function(a){m[d]=a;++r!==g||k||(k=!0,u.resolve(w,m))},function(a){k||(k=!0,u.reject(w,a))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var g=a.length,k=!1;if(!g)return this.resolve([]);for(var m=Array(g),r=0,v=-1,w=new this(q);++v<g;)d(a[v],v);return w};k.race=function(a){function d(a){f.resolve(a).then(function(a){k||
(k=!0,u.resolve(r,a))},function(a){k||(k=!0,u.reject(r,a))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var g=a.length,k=!1;if(!g)return this.resolve([]);for(var m=-1,r=new this(q);++m<g;)d(a[m]);return r}},{1:1}],3:[function(d,g,m){g="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};"function"!=typeof g.Promise&&(g.Promise=d(2))},{2:2}],4:[function(d,g,m){function q(b,
c){b=b||[];c=c||{};try{return new Blob(b,c)}catch(l){if("TypeError"!==l.name)throw l;for(var e=new ("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),a=0;a<b.length;a+=1)e.append(b[a]);return e.getBlob(c.type)}}function k(b,c){c&&b.then(function(b){c(null,b)},function(b){c(b)})}function r(b,c,e){"function"==typeof c&&b.then(c);"function"==typeof e&&b.catch(e)}function a(b){return"string"!=
typeof b&&(console.warn(b+" used as a key, but it is not a string."),b=String(b)),b}function f(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function v(b){return(new n(function(c){var e=b.transaction(R,M),a=q([""]);e.objectStore(R).put(a,"key");e.onabort=function(b){b.preventDefault();b.stopPropagation();c(!1)};e.oncomplete=function(){var b=navigator.userAgent.match(/Chrome\/(\d+)/),e=navigator.userAgent.match(/Edge\//);c(e||!b||43<=parseInt(b[1],
10))}})).catch(function(){return!1})}function L(b){return"boolean"==typeof S?n.resolve(S):v(b).then(function(b){return S=b})}function w(b){b=x[b.name];var c={};c.promise=new n(function(b,a){c.resolve=b;c.reject=a});b.deferredOperations.push(c);b.dbReady?b.dbReady=b.dbReady.then(function(){return c.promise}):b.dbReady=c.promise}function u(b){if(b=x[b.name].deferredOperations.pop())return b.resolve(),b.promise}function E(b,c){if(b=x[b.name].deferredOperations.pop())return b.reject(c),b.promise}function A(b,
c){return new n(function(e,a){if(x[b.name]=x[b.name]||aa(),b.db){if(!c)return e(b.db);w(b);b.db.close()}var t=[b.name];c&&t.push(b.version);var h=I.open.apply(I,t);c&&(h.onupgradeneeded=function(c){var e=h.result;try{e.createObjectStore(b.storeName),1>=c.oldVersion&&e.createObjectStore(R)}catch(y){if("ConstraintError"!==y.name)throw y;console.warn('The database "'+b.name+'" has been upgraded from version '+c.oldVersion+" to version "+c.newVersion+', but the storage "'+b.storeName+'" already exists.')}});
h.onerror=function(b){b.preventDefault();a(h.error)};h.onsuccess=function(){e(h.result);u(b)}})}function H(b,c){if(!b.db)return!0;var e=!b.db.objectStoreNames.contains(b.storeName),a=b.version>b.db.version;return(b.version<b.db.version&&(b.version!==c&&console.warn('The database "'+b.name+"\" can't be downgraded from version "+b.db.version+" to version "+b.version+"."),b.version=b.db.version),a||e)?(e&&(c=b.db.version+1,c>b.version&&(b.version=c)),!0):!1}function ka(b){return new n(function(c,e){var a=
new FileReader;a.onerror=e;a.onloadend=function(e){e=btoa(e.target.result||"");c({__local_forage_encoded_blob:!0,data:e,type:b.type})};a.readAsBinaryString(b)})}function Y(b){for(var c=atob(b.data),e=c.length,a=new ArrayBuffer(e),l=new Uint8Array(a),h=0;h<e;h++)l[h]=c.charCodeAt(h);return q([a],{type:b.type})}function la(b){var c=this,e=c._initReady().then(function(){var b=x[c._dbInfo.name];if(b&&b.dbReady)return b.dbReady});return r(e,b,b),e}function P(b){w(b);for(var c=x[b.name],e=c.forages,a=0;a<
e.length;a++){var l=e[a];l._dbInfo.db&&(l._dbInfo.db.close(),l._dbInfo.db=null)}return b.db=null,A(b,!1).then(function(c){return b.db=c,H(b)?A(b,!0):c}).then(function(a){b.db=c.db=a;for(var h=0;h<e.length;h++)e[h]._dbInfo.db=a}).catch(function(c){throw E(b,c),c;})}function z(b,c,e,a){void 0===a&&(a=1);try{var t=b.db.transaction(b.storeName,c);e(null,t)}catch(h){if(0<a&&(!b.db||"InvalidStateError"===h.name||"NotFoundError"===h.name))return n.resolve().then(function(){if(!b.db||"NotFoundError"===h.name&&
!b.db.objectStoreNames.contains(b.storeName)&&b.version<=b.db.version)return b.db&&(b.version=b.db.version+1),A(b,!0)}).then(function(){return P(b).then(function(){z(b,c,e,a-1)})}).catch(e);e(h)}}function aa(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Z(b){var c=.75*b.length;var e=b.length,a=0;"="===b[b.length-1]&&(c--,"="===b[b.length-2]&&c--);var l=new ArrayBuffer(c),h=new Uint8Array(l);for(c=0;c<e;c+=4){var d=C.indexOf(b[c]);var da=C.indexOf(b[c+1]);var y=C.indexOf(b[c+
2]);var f=C.indexOf(b[c+3]);h[a++]=d<<2|da>>4;h[a++]=(15&da)<<4|y>>2;h[a++]=(3&y)<<6|63&f}return l}function Q(b){var c=new Uint8Array(b),e="";for(b=0;b<c.length;b+=3)e+=C[c[b]>>2],e+=C[(3&c[b])<<4|c[b+1]>>4],e+=C[(15&c[b+1])<<2|c[b+2]>>6],e+=C[63&c[b+2]];return 2==c.length%3?e=e.substring(0,e.length-1)+"=":1==c.length%3&&(e=e.substring(0,e.length-2)+"=="),e}function ca(b,c,e,a){b.executeSql("CREATE TABLE IF NOT EXISTS "+c.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],e,a)}function B(b,
c,e,a,l,h){b.executeSql(e,a,l,function(b,t){t.code===t.SYNTAX_ERR?b.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[c.storeName],function(b,d){d.rows.length?h(b,t):ca(b,c,function(){b.executeSql(e,a,l,h)},h)},h):h(b,t)},h)}function ba(b,c,e,t){var l=this;b=a(b);var h=new n(function(a,h){l.ready().then(function(){void 0===c&&(c=null);var d=c,D=l._dbInfo;D.serializer.serialize(c,function(c,y){y?h(y):D.db.transaction(function(e){B(e,D,"INSERT OR REPLACE INTO "+D.storeName+
" (key, value) VALUES (?, ?)",[b,c],function(){a(d)},function(b,c){h(c)})},function(c){if(c.code===c.QUOTA_ERR){if(0<t)return void a(ba.apply(l,[b,d,e,t-1]));h(c)}})})}).catch(h)});return k(h,e),h}function ma(b){return new n(function(c,e){b.transaction(function(a){a.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(e,a){e=[];for(var h=0;h<a.rows.length;h++)e.push(a.rows.item(h).name);c({db:b,storeNames:e})},function(b,c){e(c)})},function(b){e(b)})})}
function ea(b,c){var e=b.name+"/";return b.storeName!==c.storeName&&(e+=b.storeName+"/"),e}function na(b,c){b[c]=function(){var e=arguments;return b.ready().then(function(){return b[c].apply(b,e)})}}function V(){for(var b=1;b<arguments.length;b++){var c=arguments[b];if(c)for(var e in c)c.hasOwnProperty(e)&&(fa(c[e])?arguments[0][e]=c[e].slice():arguments[0][e]=c[e])}return arguments[0]}var oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&
"function"==typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},I=function(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}();"undefined"==typeof Promise&&d(3);var n=Promise,R="local-forage-detect-blob-support",S=void 0,x={},pa=Object.prototype.toString,
M="readwrite";d={_driver:"asyncStorage",_initStorage:function(b){function c(){return n.resolve()}var e=this,a={db:null};if(b)for(var l in b)a[l]=b[l];var h=x[a.name];h||(h=aa(),x[a.name]=h);h.forages.push(e);e._initReady||(e._initReady=e.ready,e.ready=la);b=[];for(l=0;l<h.forages.length;l++){var d=h.forages[l];d!==e&&b.push(d._initReady().catch(c))}var f=h.forages.slice(0);return n.all(b).then(function(){return a.db=h.db,A(a,!1)}).then(function(b){return a.db=b,H(a,e._defaultConfig.version)?A(a,!0):
b}).then(function(b){a.db=h.db=b;e._dbInfo=a;for(b=0;b<f.length;b++){var c=f[b];c!==e&&(c._dbInfo.db=a.db,c._dbInfo.version=a.version)}})},_support:function(){try{if(!I)return!1;var b="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),c="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!b||c)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),
iterate:function(b,c){var e=this,a=new n(function(c,a){e.ready().then(function(){z(e._dbInfo,"readonly",function(h,l){if(h)return a(h);try{var d=l.objectStore(e._dbInfo.storeName).openCursor(),t=1;d.onsuccess=function(){var a=d.result;if(a){var e=a.value;e&&e.__local_forage_encoded_blob&&(e=Y(e));e=b(e,a.key,t++);void 0!==e?c(e):a.continue()}else c()};d.onerror=function(){a(d.error)}}catch(T){a(T)}})}).catch(a)});return k(a,c),a},getItem:function(b,c){var e=this;b=a(b);var d=new n(function(c,a){e.ready().then(function(){z(e._dbInfo,
"readonly",function(h,d){if(h)return a(h);try{var l=d.objectStore(e._dbInfo.storeName).get(b);l.onsuccess=function(){var b=l.result;void 0===b&&(b=null);b&&b.__local_forage_encoded_blob&&(b=Y(b));c(b)};l.onerror=function(){a(l.error)}}catch(J){a(J)}})}).catch(a)});return k(d,c),d},setItem:function(b,c,e){var d=this;b=a(b);var l=new n(function(a,e){var h;d.ready().then(function(){return h=d._dbInfo,"[object Blob]"===pa.call(c)?L(h.db).then(function(b){return b?c:ka(c)}):c}).then(function(c){z(d._dbInfo,
M,function(h,l){if(h)return e(h);try{var t=l.objectStore(d._dbInfo.storeName);null===c&&(c=void 0);var f=t.put(c,b);l.oncomplete=function(){void 0===c&&(c=null);a(c)};l.onabort=l.onerror=function(){e(f.error?f.error:f.transaction.error)}}catch(U){e(U)}})}).catch(e)});return k(l,e),l},removeItem:function(b,c){var e=this;b=a(b);var d=new n(function(c,a){e.ready().then(function(){z(e._dbInfo,M,function(h,d){if(h)return a(h);try{var l=d.objectStore(e._dbInfo.storeName).delete(b);d.oncomplete=function(){c()};
d.onerror=function(){a(l.error)};d.onabort=function(){a(l.error?l.error:l.transaction.error)}}catch(J){a(J)}})}).catch(a)});return k(d,c),d},clear:function(b){var c=this,a=new n(function(b,a){c.ready().then(function(){z(c._dbInfo,M,function(e,d){if(e)return a(e);try{var h=d.objectStore(c._dbInfo.storeName).clear();d.oncomplete=function(){b()};d.onabort=d.onerror=function(){a(h.error?h.error:h.transaction.error)}}catch(y){a(y)}})}).catch(a)});return k(a,b),a},length:function(b){var c=this,a=new n(function(b,
a){c.ready().then(function(){z(c._dbInfo,"readonly",function(e,d){if(e)return a(e);try{var h=d.objectStore(c._dbInfo.storeName).count();h.onsuccess=function(){b(h.result)};h.onerror=function(){a(h.error)}}catch(y){a(y)}})}).catch(a)});return k(a,b),a},key:function(b,c){var a=this,d=new n(function(c,e){if(0>b)return void c(null);a.ready().then(function(){z(a._dbInfo,"readonly",function(d,h){if(d)return e(d);try{var l=!1,t=h.objectStore(a._dbInfo.storeName).openCursor();t.onsuccess=function(){var a=
t.result;if(!a)return void c(null);0===b?c(a.key):l?c(a.key):(l=!0,a.advance(b))};t.onerror=function(){e(t.error)}}catch(T){e(T)}})}).catch(e)});return k(d,c),d},keys:function(b){var c=this,a=new n(function(b,a){c.ready().then(function(){z(c._dbInfo,"readonly",function(e,d){if(e)return a(e);try{var h=d.objectStore(c._dbInfo.storeName).openCursor(),l=[];h.onsuccess=function(){var a=h.result;if(!a)return void b(l);l.push(a.key);a.continue()};h.onerror=function(){a(h.error)}}catch(J){a(J)}})}).catch(a)});
return k(a,b),a},dropInstance:function(b,a){a=f.apply(this,arguments);var c=this.config();b="function"!=typeof b&&b||{};b.name||(b.name=b.name||c.name,b.storeName=b.storeName||c.storeName);b.name?(c=b.name===c.name&&this._dbInfo.db?n.resolve(this._dbInfo.db):A(b,!1).then(function(a){var c=x[b.name],e=c.forages;c.db=a;for(c=0;c<e.length;c++)e[c]._dbInfo.db=a;return a}),c=b.storeName?c.then(function(c){if(c.objectStoreNames.contains(b.storeName)){var a=c.version+1;w(b);var e=x[b.name],d=e.forages;c.close();
for(c=0;c<d.length;c++){var f=d[c];f._dbInfo.db=null;f._dbInfo.version=a}return(new n(function(c,e){var d=I.open(b.name,a);d.onerror=function(b){d.result.close();e(b)};d.onupgradeneeded=function(){d.result.deleteObjectStore(b.storeName)};d.onsuccess=function(){var b=d.result;b.close();c(b)}})).then(function(b){e.db=b;for(var c=0;c<d.length;c++){var a=d[c];a._dbInfo.db=b;u(a._dbInfo)}}).catch(function(c){throw(E(b,c)||n.resolve()).catch(function(){}),c;})}}):c.then(function(c){w(b);var a=x[b.name],
e=a.forages;c.close();for(c=0;c<e.length;c++)e[c]._dbInfo.db=null;return(new n(function(c,a){var e=I.deleteDatabase(b.name);e.onerror=e.onblocked=function(b){var c=e.result;c&&c.close();a(b)};e.onsuccess=function(){var b=e.result;b&&b.close();c(b)}})).then(function(b){a.db=b;for(b=0;b<e.length;b++)u(e[b]._dbInfo)}).catch(function(c){throw(E(b,c)||n.resolve()).catch(function(){}),c;})})):c=n.reject("Invalid arguments");return k(c,a),c}};var C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",
ha=/^~~local_forage_type~([^~]+)~/,ia=Object.prototype.toString,W={serialize:function(b,c){var a="";if(b&&(a=ia.call(b)),b&&("[object ArrayBuffer]"===a||b.buffer&&"[object ArrayBuffer]"===ia.call(b.buffer))){var d,l="__lfsc__:";b instanceof ArrayBuffer?(d=b,l+="arbf"):(d=b.buffer,"[object Int8Array]"===a?l+="si08":"[object Uint8Array]"===a?l+="ui08":"[object Uint8ClampedArray]"===a?l+="uic8":"[object Int16Array]"===a?l+="si16":"[object Uint16Array]"===a?l+="ur16":"[object Int32Array]"===a?l+="si32":
"[object Uint32Array]"===a?l+="ui32":"[object Float32Array]"===a?l+="fl32":"[object Float64Array]"===a?l+="fl64":c(Error("Failed to get type for BinaryArray")));c(l+Q(d))}else if("[object Blob]"===a)a=new FileReader,a.onload=function(){var a="~~local_forage_type~"+b.type+"~"+Q(this.result);c("__lfsc__:blob"+a)},a.readAsArrayBuffer(b);else try{c(JSON.stringify(b))}catch(h){console.error("Couldn't convert value into a JSON string: ",b),c(null,h)}},deserialize:function(b){if("__lfsc__:"!==b.substring(0,
9))return JSON.parse(b);var c=b.substring(13);b=b.substring(9,13);if("blob"===b&&ha.test(c)){var a=c.match(ha);var d=a[1];c=c.substring(a[0].length)}c=Z(c);switch(b){case "arbf":return c;case "blob":return q([c],{type:d});case "si08":return new Int8Array(c);case "ui08":return new Uint8Array(c);case "uic8":return new Uint8ClampedArray(c);case "si16":return new Int16Array(c);case "ur16":return new Uint16Array(c);case "si32":return new Int32Array(c);case "ui32":return new Uint32Array(c);case "fl32":return new Float32Array(c);
case "fl64":return new Float64Array(c);default:throw Error("Unkown type: "+b);}},stringToBuffer:Z,bufferToString:Q};m={_driver:"webSQLStorage",_initStorage:function(b){var c=this,a={db:null};if(b)for(var d in b)a[d]="string"!=typeof b[d]?b[d].toString():b[d];b=new n(function(b,e){try{a.db=openDatabase(a.name,String(a.version),a.description,a.size)}catch(D){return e(D)}a.db.transaction(function(d){ca(d,a,function(){c._dbInfo=a;b()},function(b,a){e(a)})},e)});return a.serializer=W,b},_support:"function"==
typeof openDatabase,iterate:function(b,a){var c=this,d=new n(function(a,e){c.ready().then(function(){var d=c._dbInfo;d.db.transaction(function(c){B(c,d,"SELECT * FROM "+d.storeName,[],function(c,e){c=e.rows;e=c.length;for(var h=0;h<e;h++){var l=c.item(h),f=l.value;if(f&&(f=d.serializer.deserialize(f)),void 0!==(f=b(f,l.key,h+1)))return void a(f)}a()},function(b,a){e(a)})})}).catch(e)});return k(d,a),d},getItem:function(b,c){var e=this;b=a(b);var d=new n(function(a,c){e.ready().then(function(){var d=
e._dbInfo;d.db.transaction(function(e){B(e,d,"SELECT * FROM "+d.storeName+" WHERE key = ? LIMIT 1",[b],function(b,c){(b=c.rows.length?c.rows.item(0).value:null)&&(b=d.serializer.deserialize(b));a(b)},function(b,a){c(a)})})}).catch(c)});return k(d,c),d},setItem:function(b,a,e){return ba.apply(this,[b,a,e,1])},removeItem:function(b,c){var e=this;b=a(b);var d=new n(function(a,c){e.ready().then(function(){var d=e._dbInfo;d.db.transaction(function(e){B(e,d,"DELETE FROM "+d.storeName+" WHERE key = ?",[b],
function(){a()},function(b,a){c(a)})})}).catch(c)});return k(d,c),d},clear:function(b){var a=this,e=new n(function(b,c){a.ready().then(function(){var e=a._dbInfo;e.db.transaction(function(a){B(a,e,"DELETE FROM "+e.storeName,[],function(){b()},function(b,a){c(a)})})}).catch(c)});return k(e,b),e},length:function(b){var a=this,e=new n(function(b,c){a.ready().then(function(){var e=a._dbInfo;e.db.transaction(function(a){B(a,e,"SELECT COUNT(key) as c FROM "+e.storeName,[],function(a,c){a=c.rows.item(0).c;
b(a)},function(b,a){c(a)})})}).catch(c)});return k(e,b),e},key:function(b,a){var c=this,d=new n(function(a,e){c.ready().then(function(){var d=c._dbInfo;d.db.transaction(function(c){B(c,d,"SELECT key FROM "+d.storeName+" WHERE id = ? LIMIT 1",[b+1],function(b,c){b=c.rows.length?c.rows.item(0).key:null;a(b)},function(b,a){e(a)})})}).catch(e)});return k(d,a),d},keys:function(b){var a=this,e=new n(function(b,c){a.ready().then(function(){var e=a._dbInfo;e.db.transaction(function(a){B(a,e,"SELECT key FROM "+
e.storeName,[],function(a,c){a=[];for(var e=0;e<c.rows.length;e++)a.push(c.rows.item(e).key);b(a)},function(b,a){c(a)})})}).catch(c)});return k(e,b),e},dropInstance:function(b,a){a=f.apply(this,arguments);var c=this.config();b="function"!=typeof b&&b||{};b.name||(b.name=b.name||c.name,b.storeName=b.storeName||c.storeName);var d,l=this;return d=b.name?(new n(function(a){var e=b.name===c.name?l._dbInfo.db:openDatabase(b.name,"","",0);a(b.storeName?{db:e,storeNames:[b.storeName]}:ma(e))})).then(function(b){return new n(function(a,
c){b.db.transaction(function(e){function d(b){return new n(function(a,c){e.executeSql("DROP TABLE IF EXISTS "+b,[],function(){a()},function(b,a){c(a)})})}for(var h=[],f=0,l=b.storeNames.length;f<l;f++)h.push(d(b.storeNames[f]));n.all(h).then(function(){a()}).catch(function(b){c(b)})},function(b){c(b)})})}):n.reject("Invalid arguments"),k(d,a),d}};try{var F="undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(b){F=!1}var qa=function(b,a){for(var c=b.length,d=0;d<
c;){var f=b[d],h=a;if(f===h||"number"==typeof f&&"number"==typeof h&&isNaN(f)&&isNaN(h))return!0;d++}return!1},fa=Array.isArray||function(b){return"[object Array]"===Object.prototype.toString.call(b)},K={},ja={},G={INDEXEDDB:d,WEBSQL:m,LOCALSTORAGE:{_driver:"localStorageWrapper",_initStorage:function(b){var a={};if(b)for(var e in b)a[e]=b[e];a.keyPrefix=ea(b,this._defaultConfig);try{var d=(localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1)}catch(l){d=
!0}return!d||0<localStorage.length?(this._dbInfo=a,a.serializer=W,n.resolve()):n.reject()},_support:F,iterate:function(b,a){var c=this,d=c.ready().then(function(){for(var a=c._dbInfo,e=a.keyPrefix,d=e.length,f=localStorage.length,g=1,k=0;k<f;k++){var m=localStorage.key(k);if(0===m.indexOf(e)){var t=localStorage.getItem(m);if(t&&(t=a.serializer.deserialize(t)),void 0!==(t=b(t,m.substring(d),g++)))return t}}});return k(d,a),d},getItem:function(b,c){var e=this;b=a(b);var d=e.ready().then(function(){var a=
e._dbInfo,c=localStorage.getItem(a.keyPrefix+b);return c&&(c=a.serializer.deserialize(c)),c});return k(d,c),d},setItem:function(b,c,e){var d=this;b=a(b);var f=d.ready().then(function(){void 0===c&&(c=null);var a=c;return new n(function(e,f){var h=d._dbInfo;h.serializer.serialize(c,function(c,d){if(d)f(d);else try{localStorage.setItem(h.keyPrefix+b,c),e(a)}catch(N){"QuotaExceededError"!==N.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==N.name||f(N),f(N)}})})});return k(f,e),f},removeItem:function(b,c){var e=
this;b=a(b);var d=e.ready().then(function(){localStorage.removeItem(e._dbInfo.keyPrefix+b)});return k(d,c),d},clear:function(b){var a=this,e=a.ready().then(function(){for(var b=a._dbInfo.keyPrefix,c=localStorage.length-1;0<=c;c--){var e=localStorage.key(c);0===e.indexOf(b)&&localStorage.removeItem(e)}});return k(e,b),e},length:function(b){var a=this.keys().then(function(b){return b.length});return k(a,b),a},key:function(b,a){var c=this,d=c.ready().then(function(){var a=c._dbInfo;try{var e=localStorage.key(b)}catch(D){e=
null}return e&&(e=e.substring(a.keyPrefix.length)),e});return k(d,a),d},keys:function(b){var a=this,e=a.ready().then(function(){for(var b=a._dbInfo,c=localStorage.length,e=[],d=0;d<c;d++){var f=localStorage.key(d);0===f.indexOf(b.keyPrefix)&&e.push(f.substring(b.keyPrefix.length))}return e});return k(e,b),e},dropInstance:function(b,a){if(a=f.apply(this,arguments),b="function"!=typeof b&&b||{},!b.name){var c=this.config();b.name=b.name||c.name;b.storeName=b.storeName||c.storeName}var d,g=this;return d=
b.name?(new n(function(a){a(b.storeName?ea(b,g._defaultConfig):b.name+"/")})).then(function(a){for(var b=localStorage.length-1;0<=b;b--){var c=localStorage.key(b);0===c.indexOf(a)&&localStorage.removeItem(c)}}):n.reject("Invalid arguments"),k(d,a),d}}};F=[G.INDEXEDDB._driver,G.WEBSQL._driver,G.LOCALSTORAGE._driver];var O=["dropInstance"],X="clear getItem iterate key keys length removeItem setItem".split(" ").concat(O),ra={description:"",driver:F.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",
version:1};F=new (function(){function b(a){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");for(var c in G)if(G.hasOwnProperty(c)){var d=G[c],f=d._driver;this[c]=f;K[f]||this.defineDriver(d)}this._defaultConfig=V({},ra);this._config=V({},this._defaultConfig,a);this._initDriver=this._driverSet=null;this._ready=!1;this._dbInfo=null;this._wrapLibraryMethodsWithReady();this.setDriver(this._config.driver).catch(function(){})}return b.prototype.config=function(a){if("object"===
(void 0===a?"undefined":oa(a))){if(this._ready)return Error("Can't call config() after localforage has been used.");for(var b in a){if("storeName"===b&&(a[b]=a[b].replace(/\W/g,"_")),"version"===b&&"number"!=typeof a[b])return Error("Database version must be a number.");this._config[b]=a[b]}return!("driver"in a&&a.driver)||this.setDriver(this._config.driver)}return"string"==typeof a?this._config[a]:this._config},b.prototype.defineDriver=function(a,b,d){var c=new n(function(b,c){try{var d=a._driver,
e=Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!a._driver)return void c(e);for(var f=X.concat("_initStorage"),h=0,g=f.length;h<g;h++){var l=f[h];if((!qa(O,l)||a[l])&&"function"!=typeof a[l])return void c(e)}(function(){for(var b=function(a){return function(){var b=n.reject(Error("Method "+a+" is not implemented by the current driver"));return k(b,arguments[arguments.length-1]),b}},c=0,d=O.length;c<d;c++){var e=O[c];a[e]||(a[e]=b(e))}})();e=function(c){K[d]&&
console.info("Redefining LocalForage driver: "+d);K[d]=a;ja[d]=c;b()};"_support"in a?a._support&&"function"==typeof a._support?a._support().then(e,c):e(!!a._support):e(!0)}catch(U){c(U)}});return r(c,b,d),c},b.prototype.driver=function(){return this._driver||null},b.prototype.getDriver=function(a,b,d){a=K[a]?n.resolve(K[a]):n.reject(Error("Driver not found."));return r(a,b,d),a},b.prototype.getSerializer=function(a){var b=n.resolve(W);return r(b,a),b},b.prototype.ready=function(a){var b=this,c=b._driverSet.then(function(){return null===
b._ready&&(b._ready=b._initDriver()),b._ready});return r(c,a,a),c},b.prototype.setDriver=function(a,b,d){function c(){g._config.driver=g.driver()}function e(a){return g._extend(a),c(),g._ready=g._initStorage(g._config),g._ready}function f(a){return function(){function b(){for(;d<a.length;){var f=a[d];return d++,g._dbInfo=null,g._ready=null,g.getDriver(f).then(e).catch(b)}c();return g._driverSet=n.reject(Error("No available storage method found.")),g._driverSet}var d=0;return b()}}var g=this;fa(a)||
(a=[a]);var k=this._getSupportedDrivers(a);return this._driverSet=(null!==this._driverSet?this._driverSet.catch(function(){return n.resolve()}):n.resolve()).then(function(){var a=k[0];return g._dbInfo=null,g._ready=null,g.getDriver(a).then(function(a){g._driver=a._driver;c();g._wrapLibraryMethodsWithReady();g._initDriver=f(k)})}).catch(function(){c();return g._driverSet=n.reject(Error("No available storage method found.")),g._driverSet}),r(this._driverSet,b,d),this._driverSet},b.prototype.supports=
function(a){return!!ja[a]},b.prototype._extend=function(a){V(this,a)},b.prototype._getSupportedDrivers=function(a){for(var b=[],c=0,d=a.length;c<d;c++){var f=a[c];this.supports(f)&&b.push(f)}return b},b.prototype._wrapLibraryMethodsWithReady=function(){for(var a=0,b=X.length;a<b;a++)na(this,X[a])},b.prototype.createInstance=function(a){return new b(a)},b}());g.exports=F},{3:3}]},{},[4])(4)});
let dbrStoreConsumption,dbrStoreLicenseInfo,dbrBSendSmallRecordsForDebug,dbrSessionDuration,dbrNextPostConsumptionTime=-Infinity,dbrNextTaskId=0,dbrTaskCallbackMap=new Map,dbrAESGCMKey,dbrFuncGenAESGCMKey=()=>self.crypto.subtle.importKey("raw",new Uint8Array([80,88,27,82,145,164,199,211,187,87,89,128,150,44,190,213,99,181,118,158,215,103,76,117,29,83,122,137,5,180,157,114]),"AES-GCM",!0,["encrypt","decrypt"]),dbrFuncDecryptAndAtob=async p=>{if(self.crypto&&self.crypto.subtle&&self.crypto.subtle.importKey){var d=
atob(p),g=new Uint8Array(d.length);for(let m=0;m<d.length;++m)g[m]=d.charCodeAt(m);d=g.subarray(0,12);g=g.subarray(d.length);if(!dbrAESGCMKey)try{dbrAESGCMKey=await dbrFuncGenAESGCMKey()}catch(m){console.log(m)}g=await self.crypto.subtle.decrypt({name:"AES-GCM",iv:d,tagLength:128},dbrAESGCMKey,g);return String.fromCharCode.apply(null,new Uint8Array(g))}return await new Promise((d,g)=>{let k=dbrNextTaskId++;dbrTaskCallbackMap.set(k,k=>{if(k.success)return dbrBWasmDebug&&console.log(k.txt),d(k.txt);
{let a=Error(k.message);a.stack+="\n"+k.stack;return g(a)}});postMessage({type:"taskd",taskID:k,txt:p})})},dbrFuncEncryptAndBtoa=async p=>{if(self.crypto&&self.crypto.subtle&&self.crypto.subtle.importKey){var d=new Uint8Array(p.length);for(var g=0;g<p.length;++g)d[g]=p.charCodeAt(g);g=self.crypto.getRandomValues(new Uint8Array(12));dbrAESGCMKey||(dbrAESGCMKey=await dbrFuncGenAESGCMKey());d=await self.crypto.subtle.encrypt({name:"AES-GCM",iv:g,tagLength:128},dbrAESGCMKey,d);d=new Uint8Array(d);let m=
new Uint8Array(g.length+d.length);m.set(g);m.set(d,g.length);return btoa(String.fromCharCode.apply(null,m))}return await new Promise((d,g)=>{let k=dbrNextTaskId++;dbrTaskCallbackMap.set(k,k=>{if(k.success)return dbrBWasmDebug&&console.log(k.txt),d(k.txt);{let a=Error(k.message);a.stack+="\n"+k.stack;return g(a)}});postMessage({type:"taske",taskID:k,txt:p})})};
var Module={locateFile:function(p){return"libDynamsoftBarcodeReader.wasm"==p?dbrEngineResourcePath+"dbr-"+dbrVersion+(dbrBUseFullFeature?".full":"")+".wasm":dbrEngineResourcePath+p},printErr:console.error,onRuntimeInitialized:async function(){postMessage({type:"log",message:"wasm initialized"});let p={productKeys:dbrProductKeys,domain:dbrDomain};dbrBWasmDebug&&(p.bDebug=!0);if(dbrBRuntimeKeys){await dbrPromiseGetLicense;let d=dbrLicenseInfo;if(d instanceof Error){postMessage({type:"load",success:!1,
message:d.message,stack:d.stack});setTimeout(()=>{throw d;},0);return}if(!d.productKeys){postMessage({type:"load",success:!1,message:d.message,stack:""});return}dbrSessionDuration=1E3*d.sessionDuration;p.runtimeKeys=dbrProductKeys;p.productKeys=d.productKeys;p.consumeType=d.consumeType;p.urlGetLicense="";p.aryUrlPostConsume=p.sm_aryUrlPostConsume=[];p.bNewDevice=dbrBNewDevice;p.uuid=dbrUUID;p.initTime=Date.now().toString();sendConsume();setInterval(sendConsume,dbrSessionDuration)}Module.BarcodeReaderWasm.init(JSON.stringify(p));
postMessage({type:"load",success:!0,version:Module.BarcodeReaderWasm.getVersion()})}};let DBR_MapInstances=new Map,nextInstanceID=0;
onmessage=async function(p){var d=p.data,g=d.id,m=d.instanceID;const q=d.body;switch(d.type){case "loadWasm":dbrBWasmDebug=d.bWasmDebug;dbrEngineResourcePath=d.engineResourcePath;dbrVersion=d.version;dbrProductKeys=d.productKeys;dbrDomain=d.domain;dbrBUseFullFeature=d.bUseFullFeature;dbrUUID=d.uuid;dbrLicenseServer=d.licenseServer?d.licenseServer:dbrLicenseServer;dbrBSendSmallRecordsForDebug=d.bSendSmallRecordsForDebug;importScripts(dbrEngineResourcePath+"dbr-"+dbrVersion+(dbrBUseFullFeature?".full":
"")+".wasm.js");(dbrBRuntimeKeys=8==dbrProductKeys.length)&&(dbrPromiseGetLicense=(async()=>{try{await (await localforage.createInstance({name:"dbrjshello"})).setItem("dbrjshello","available")}catch(v){localforage=function(a){this.dbname=a};localforage.createInstance=async function(a){return new localforage(a.name)};var a=a=>function(){let d=[];for(let a=0;a<arguments.length;++a)d.push(arguments[a]);return new Promise((f,g)=>{let k=dbrNextTaskId++;dbrTaskCallbackMap.set(k,a=>{if(a.success)return dbrBWasmDebug&&
console.log(a.result),f(a.result);{let d=Error(a.message);d.stack+="\n"+a.stack;return g(d)}});postMessage({type:"localforage",taskID:k,dbname:this.dbname,method:a,paras:d})})};localforage.prototype.setItem=a("setItem");localforage.prototype.getItem=a("getItem");localforage.prototype.removeItem=a("removeItem");localforage.prototype.keys=a("keys")}dbrStoreLicenseInfo=await localforage.createInstance({name:"dbrjsLicenseInfo"});dbrStoreConsumption=await localforage.createInstance({name:"dbrjs"+dbrProductKeys+
"unsV2"});dbrBNewDevice=!await dbrStoreLicenseInfo.getItem(dbrProductKeys+"old");let d;if(a=await dbrStoreLicenseInfo.getItem(dbrProductKeys))[a,d]=a,Date.now()>a&&(await dbrStoreLicenseInfo.removeItem(dbrProductKeys),d=null);try{await Promise.race([fetch(dbrLicenseServer+"api/verification/"+dbrProductKeys).then(a=>{if(a.ok)return a.text();throw Error("Network Error. Can't get license.");}).then(a=>{d=a;return dbrStoreLicenseInfo.setItem(dbrProductKeys,[Date.now()+6048E5,d])}),new Promise((a,f)=>
{setTimeout(()=>f(Error("Network Error. Request timeout.")),d?3E3:15E3)})])}catch(v){if(dbrBWasmDebug&&console.error(v),null==d){dbrLicenseInfo=v;return}}dbrLicenseInfo=await dbrFuncDecryptAndAtob(d).then(a=>JSON.parse(a)).catch(()=>Error("Parse Error. Can't get valid license."))})());break;case "createInstance":m=nextInstanceID++;try{let a=new Module.BarcodeReaderWasm(d.bScanner,m);DBR_MapInstances.set(m,a);let f=JSON.parse(a.getRuntimeSettings());d.bScanner?(f.localizationModes=[2,0,0,0,0,0,0,0],
f.deblurLevel=2):f.expectedBarcodesCount=999;dbrBUseFullFeature||(f.barcodeFormatIds=234883071);a.updateRuntimeSettings(JSON.stringify(f))}catch(a){handleErr(a,g);break}postMessage({type:"task",id:g,body:{success:!0,instanceID:m}});break;case "destroy":try{DBR_MapInstances.get(m).delete(),DBR_MapInstances.delete(m)}catch(a){handleErr(a,g);break}postMessage({type:"task",id:g,body:{success:!0}});break;case "decodeBuffer":{let a;try{a=JSON.parse(DBR_MapInstances.get(m).decodeBuffer(q.buffer,q.width,
q.height,q.stride,q.format))}catch(f){handleErr(f,g);break}postMessage({type:"task",id:g,body:{success:!0,decodeReturn:a}});break}case "getRuntimeSettings":{let a;try{a=DBR_MapInstances.get(m).getRuntimeSettings()}catch(f){handleErr(f,g);break}postMessage({type:"task",id:g,body:{success:!0,results:a}});break}case "updateRuntimeSettings":{let a;try{a=JSON.parse(DBR_MapInstances.get(m).updateRuntimeSettings(q.settings))}catch(f){handleErr(f,g);break}postMessage({type:"task",id:g,body:{success:!0,updateReturn:a}});
break}case "resetRuntimeSettings":try{DBR_MapInstances.get(m).resetRuntimeSettings()}catch(a){handleErr(p,g);break}this.postMessage({type:"task",id:g,body:{success:!0}});break;case "outputSettingsToString":{let a;try{a=DBR_MapInstances.get(m).outputSettingsToString()}catch(f){handleErr(f,g);break}postMessage({type:"task",id:g,body:{success:!0,results:a}});break}case "initRuntimeSettingsWithString":{let a;try{a=JSON.parse(DBR_MapInstances.get(m).initRuntimeSettingsWithString(q.settings))}catch(f){handleErr(f,
g);break}postMessage({type:"task",id:g,body:{success:!0,initReturn:a}});break}case "getIntermediateResults":{let a=null;try{var k=DBR_MapInstances.get(m).getIntermediateResults(),r=JSON.parse(k,(d,g)=>"bytes"===d&&"ptr"in g&&"length"in g?a=Module.BarcodeReaderWasm.getBytes(g.ptr,g.length):g);DBR_MapInstances.get(m).freeIntermediateResults()}catch(f){handleErr(f,g);break}this.postMessage({type:"task",id:g,body:{success:!0,results:r}});break}case "setModeArgument":{let a;try{a=JSON.parse(DBR_MapInstances.get(m).setModeArgument(q.modeName,
q.index,q.argumentName,q.argumentValue))}catch(f){handleErr(f,g);break}this.postMessage({type:"task",id:g,body:{success:!0,setReturn:a}});break}case "updateScanSettings":try{let a=DBR_MapInstances.get(m),d=q.settings;a.duplicateForgetTime=d.duplicateForgetTime;a.oneDRememberFrameCount=d.oneDRememberFrameCount;a.oneDTrustFrameCount=d.oneDTrustFrameCount;d.frameFilter?a.setFrameFilter(JSON.stringify(d.frameFilter)):a.setFrameFilter("")}catch(a){handleErr(a,g);break}this.postMessage({type:"task",id:g,
body:{success:!0}});break;case "getScanSettings":d={};try{let a=DBR_MapInstances.get(m);d.duplicateForgetTime=a.duplicateForgetTime;d.oneDRememberFrameCount=a.oneDRememberFrameCount;d.oneDTrustFrameCount=a.oneDTrustFrameCount;let f=a.getFrameFilter();f&&(d.frameFilter=JSON.parse(f))}catch(a){handleErr(a,g);break}this.postMessage({type:"task",id:g,body:{success:!0,results:d}});break;case "task":g=d.id;d=d.body;try{dbrTaskCallbackMap.get(g)(d),dbrTaskCallbackMap.delete(g)}catch(a){throw dbrTaskCallbackMap.delete(g),
a;}break;default:console.warn("Unmatched task: ",p)}};
let handleErr=(p,d)=>{postMessage({type:"task",id:d,body:{success:!1,message:p.message,stack:p.stack}});setTimeout(()=>{throw p;},0)},addConsumeRecordToDB=async p=>{dbrBWasmDebug&&console.log("%c","color:#0f0",atob(p));await dbrStoreConsumption.setItem(Date.now().toString(),p);dbrNextPostConsumptionTime<Date.now()&&(dbrNextPostConsumptionTime=Date.now()+dbrSessionDuration,sendConsume())},sendConsume=async()=>{dbrPromisePostConsumption=dbrPromisePostConsumption.then(async()=>{var p=Date.now();let d=
await dbrStoreConsumption.keys();if(d.length){dbrBWasmDebug&&console.log("get keys to filter for send: %o",d);var g=[],m=new Map;for(let k of d){let d=JSON.parse(atob(await dbrStoreConsumption.getItem(k))),a;dbrBNewDevice?(dbrBNewDevice=!1,await dbrStoreLicenseInfo.setItem(dbrProductKeys+"old",dbrUUID),a=Math.floor(d.decodeTime/dbrSessionDuration)*dbrSessionDuration):a=Math.ceil(d.decodeTime/dbrSessionDuration)*dbrSessionDuration;dbrBSendSmallRecordsForDebug&&(a=parseInt(d.decodeTime));dbrBWasmDebug&&
console.log("timeKey: %d, dateNow: %d",a,p);if(a>p)continue;g.push(k);let f=m.has(a)?m.get(a):{all:0,oned:0,qr:0,pdf417:0,dm:0,mc:0,other:0};f.all+=d.consumption.all;f.oned+=d.consumption.oned;f.qr+=d.consumption.qr;f.pdf417+=d.consumption.pdf417;f.dm+=d.consumption.dm;f.mc+=d.consumption.mc;f.other+=d.consumption.other;m.set(a,f)}if(g.length){dbrBWasmDebug&&console.log("get keys for send: %o",d);dbrNextPostConsumptionTime=p+dbrSessionDuration;var q=[];m.forEach((d,g)=>{q.push({recordTime:g,consumption:d})});
p={version:"2",runtimeKeys:dbrProductKeys,uuid:dbrUUID,postTime:Date.now(),records:q};dbrBWasmDebug&&dbrBWasmDebug&&console.log(p);await fetch(dbrLicenseServer+"api/verification",{mode:"cors",method:"POST",body:await dbrFuncEncryptAndBtoa(JSON.stringify(p))}).then(async d=>{if(d.ok)for(let d of g)await dbrStoreConsumption.removeItem(d)},d=>{console.error(d)})}}})};
